{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/geonleea01702148/RETO/blob/main/DS_C2_SC2_GEONLEE.ipynb%20intento2\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# 새 섹션"
      ],
      "metadata": {
        "id": "nXZ9i7n6T940"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Librerías necesarias\n",
        "from google.colab import drive\n",
        "import pandas as pd\n",
        "\n",
        "# Montar Google Drive\n",
        "drive.mount('/content/drive')\n",
        "\n",
        "# Cargar archivo en un DataFrame\n",
        "file_path = '/content/drive/My Drive/country_vaccinations.csv'\n",
        "df = pd.read_csv(file_path)\n",
        "\n",
        "# Sección 1: Recuperar la información del archivo\n",
        "print(\"Primeras filas del archivo:\")\n",
        "print(df.head())\n",
        "\n",
        "# Sección 2: Obtener estructura y tipos de datos de cada columna\n",
        "print(\"\\nInformación del DataFrame:\")\n",
        "df.info()\n",
        "\n",
        "print(\"\\nEstadísticas descriptivas:\")\n",
        "print(df.describe())\n",
        "\n",
        "# Asegurarse de que la columna 'date' sea datetime\n",
        "df['date'] = pd.to_datetime(df['date'])\n",
        "\n",
        "# Sección 3: Cantidad de vacunas aplicadas por compañía\n",
        "vaccines_by_company = df.groupby('vaccines')['total_vaccinations'].sum()\n",
        "print(\"\\nCantidad de vacunas aplicadas por compañía:\")\n",
        "print(vaccines_by_company)\n",
        "\n",
        "# Sección 4: Cantidad de vacunas aplicadas en todo el mundo\n",
        "total_vaccinations_world = df['total_vaccinations'].sum()\n",
        "print(\"\\nCantidad total de vacunas aplicadas en todo el mundo:\", total_vaccinations_world)\n",
        "\n",
        "# Sección 5: Promedio de vacunas aplicadas por país\n",
        "avg_vaccinations_per_country = df.groupby('country')['total_vaccinations'].mean()\n",
        "print(\"\\nPromedio de vacunas aplicadas por país:\")\n",
        "print(avg_vaccinations_per_country.head())\n",
        "\n",
        "# Sección 6: Cantidad de vacunas aplicadas el 29/01/2021\n",
        "vaccinations_on_29_jan = df[df['date'] == '2021-01-29']['total_vaccinations'].sum()\n",
        "print(\"\\nVacunas aplicadas el 29/01/2021:\", vaccinations_on_29_jan)\n",
        "\n",
        "# Sección 7: DataFrame con diferencias de tiempo\n",
        "df_sorted = df.sort_values(by=['country', 'date'])\n",
        "df_sorted['date_difference'] = df_sorted.groupby('country')['date'].diff().dt.days\n",
        "df_with_differences = df_sorted.copy()\n",
        "print(\"\\nDataFrame con diferencias de tiempo (primeras 5 filas):\")\n",
        "print(df_with_differences.head())\n",
        "\n",
        "# Sección 8: DataFrame con cantidad total por país\n",
        "df_with_quantity = df.groupby('country')['total_vaccinations'].sum().reset_index()\n",
        "df_with_quantity.rename(columns={'total_vaccinations': 'total_vaccinations_by_country'}, inplace=True)\n",
        "print(\"\\nDataFrame con cantidad total por país:\")\n",
        "print(df_with_quantity.head())\n",
        "\n",
        "# Sección 9: DataFrame con registros antes del 20 de diciembre de 2020\n",
        "before_20_dec = df[df['date'] < '2020-12-20']\n",
        "print(\"\\nRegistros antes del 20/12/2020 (primeras 5 filas):\")\n",
        "print(before_20_dec.head())\n",
        "\n",
        "# Sección 10: DataFrame con registros de la vacuna Pfizer\n",
        "pfizer_data = df[df['vaccines'].str.contains('Pfizer', case=False, na=False)]\n",
        "print(\"\\nRegistros de la vacuna Pfizer (primeras 5 filas):\")\n",
        "print(pfizer_data.head())\n",
        "\n",
        "# Guardar los DataFrames en un único archivo Excel\n",
        "output_path_excel = '/content/vaccination_data.xlsx'\n",
        "with pd.ExcelWriter(output_path_excel) as writer:\n",
        "    vaccines_by_company.to_excel(writer, sheet_name='Vacunas por Compañía')\n",
        "    df_with_differences.to_excel(writer, sheet_name='Diferencias', index=False)\n",
        "    df_with_quantity.to_excel(writer, sheet_name='Cantidad Total', index=False)\n",
        "    before_20_dec.to_excel(writer, sheet_name='Antes del 20 Dic', index=False)\n",
        "    pfizer_data.to_excel(writer, sheet_name='Pfizer', index=False)\n",
        "\n",
        "print(\"\\nTodos los DataFrames se han guardado en el archivo Excel en la ruta:\")\n",
        "print(output_path_excel)\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "nOWoGJeKT_Du",
        "outputId": "96a6a134-609f-4584-cea6-6dd297f67075"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n",
            "Primeras filas del archivo:\n",
            "       country iso_code        date  total_vaccinations  people_vaccinated  \\\n",
            "0  Afghanistan      AFG  2021-02-22                 0.0                0.0   \n",
            "1  Afghanistan      AFG  2021-02-23                 NaN                NaN   \n",
            "2  Afghanistan      AFG  2021-02-24                 NaN                NaN   \n",
            "3  Afghanistan      AFG  2021-02-25                 NaN                NaN   \n",
            "4  Afghanistan      AFG  2021-02-26                 NaN                NaN   \n",
            "\n",
            "   people_fully_vaccinated  daily_vaccinations_raw  daily_vaccinations  \\\n",
            "0                      NaN                     NaN                 NaN   \n",
            "1                      NaN                     NaN              1367.0   \n",
            "2                      NaN                     NaN              1367.0   \n",
            "3                      NaN                     NaN              1367.0   \n",
            "4                      NaN                     NaN              1367.0   \n",
            "\n",
            "   total_vaccinations_per_hundred  people_vaccinated_per_hundred  \\\n",
            "0                             0.0                            0.0   \n",
            "1                             NaN                            NaN   \n",
            "2                             NaN                            NaN   \n",
            "3                             NaN                            NaN   \n",
            "4                             NaN                            NaN   \n",
            "\n",
            "   people_fully_vaccinated_per_hundred  daily_vaccinations_per_million  \\\n",
            "0                                  NaN                             NaN   \n",
            "1                                  NaN                            34.0   \n",
            "2                                  NaN                            34.0   \n",
            "3                                  NaN                            34.0   \n",
            "4                                  NaN                            34.0   \n",
            "\n",
            "                                            vaccines  \\\n",
            "0  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "1  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "2  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "3  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "4  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "\n",
            "                 source_name            source_website  \n",
            "0  World Health Organization  https://covid19.who.int/  \n",
            "1  World Health Organization  https://covid19.who.int/  \n",
            "2  World Health Organization  https://covid19.who.int/  \n",
            "3  World Health Organization  https://covid19.who.int/  \n",
            "4  World Health Organization  https://covid19.who.int/  \n",
            "\n",
            "Información del DataFrame:\n",
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 86512 entries, 0 to 86511\n",
            "Data columns (total 15 columns):\n",
            " #   Column                               Non-Null Count  Dtype  \n",
            "---  ------                               --------------  -----  \n",
            " 0   country                              86512 non-null  object \n",
            " 1   iso_code                             86512 non-null  object \n",
            " 2   date                                 86512 non-null  object \n",
            " 3   total_vaccinations                   43607 non-null  float64\n",
            " 4   people_vaccinated                    41294 non-null  float64\n",
            " 5   people_fully_vaccinated              38802 non-null  float64\n",
            " 6   daily_vaccinations_raw               35362 non-null  float64\n",
            " 7   daily_vaccinations                   86213 non-null  float64\n",
            " 8   total_vaccinations_per_hundred       43607 non-null  float64\n",
            " 9   people_vaccinated_per_hundred        41294 non-null  float64\n",
            " 10  people_fully_vaccinated_per_hundred  38802 non-null  float64\n",
            " 11  daily_vaccinations_per_million       86213 non-null  float64\n",
            " 12  vaccines                             86512 non-null  object \n",
            " 13  source_name                          86512 non-null  object \n",
            " 14  source_website                       86512 non-null  object \n",
            "dtypes: float64(9), object(6)\n",
            "memory usage: 9.9+ MB\n",
            "\n",
            "Estadísticas descriptivas:\n",
            "       total_vaccinations  people_vaccinated  people_fully_vaccinated  \\\n",
            "count        4.360700e+04       4.129400e+04             3.880200e+04   \n",
            "mean         4.592964e+07       1.770508e+07             1.413830e+07   \n",
            "std          2.246004e+08       7.078731e+07             5.713920e+07   \n",
            "min          0.000000e+00       0.000000e+00             1.000000e+00   \n",
            "25%          5.264100e+05       3.494642e+05             2.439622e+05   \n",
            "50%          3.590096e+06       2.187310e+06             1.722140e+06   \n",
            "75%          1.701230e+07       9.152520e+06             7.559870e+06   \n",
            "max          3.263129e+09       1.275541e+09             1.240777e+09   \n",
            "\n",
            "       daily_vaccinations_raw  daily_vaccinations  \\\n",
            "count            3.536200e+04        8.621300e+04   \n",
            "mean             2.705996e+05        1.313055e+05   \n",
            "std              1.212427e+06        7.682388e+05   \n",
            "min              0.000000e+00        0.000000e+00   \n",
            "25%              4.668000e+03        9.000000e+02   \n",
            "50%              2.530900e+04        7.343000e+03   \n",
            "75%              1.234925e+05        4.409800e+04   \n",
            "max              2.474100e+07        2.242429e+07   \n",
            "\n",
            "       total_vaccinations_per_hundred  people_vaccinated_per_hundred  \\\n",
            "count                    43607.000000                   41294.000000   \n",
            "mean                        80.188543                      40.927317   \n",
            "std                         67.913577                      29.290759   \n",
            "min                          0.000000                       0.000000   \n",
            "25%                         16.050000                      11.370000   \n",
            "50%                         67.520000                      41.435000   \n",
            "75%                        132.735000                      67.910000   \n",
            "max                        345.370000                     124.760000   \n",
            "\n",
            "       people_fully_vaccinated_per_hundred  daily_vaccinations_per_million  \n",
            "count                         38802.000000                    86213.000000  \n",
            "mean                             35.523243                     3257.049157  \n",
            "std                              28.376252                     3934.312440  \n",
            "min                               0.000000                        0.000000  \n",
            "25%                               7.020000                      636.000000  \n",
            "50%                              31.750000                     2050.000000  \n",
            "75%                              62.080000                     4682.000000  \n",
            "max                             122.370000                   117497.000000  \n",
            "\n",
            "Cantidad de vacunas aplicadas por compañía:\n",
            "vaccines\n",
            "Abdala, Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech, Soberana02, Sputnik Light, Sputnik V                            1.784348e+08\n",
            "Abdala, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sputnik V                                            1.791450e+10\n",
            "Abdala, Sinopharm/Beijing, Sinovac, Soberana02, Sputnik Light, Sputnik V                                                      4.228568e+08\n",
            "Abdala, Soberana Plus, Soberana02                                                                                             6.405166e+09\n",
            "COVIran Barekat, Covaxin, FAKHRAVAC, Oxford/AstraZeneca, Razi Cov Pars, Sinopharm/Beijing, Soberana02, SpikoGen, Sputnik V    1.069480e+10\n",
            "                                                                                                                                  ...     \n",
            "Pfizer/BioNTech, Sinovac, Turkovac                                                                                            3.392310e+10\n",
            "Pfizer/BioNTech, Sputnik V                                                                                                    3.863380e+06\n",
            "QazVac, Sinopharm/Beijing, Sputnik V                                                                                          3.585429e+09\n",
            "Sinopharm/Beijing                                                                                                             3.080671e+07\n",
            "Sinopharm/Beijing, Sputnik V                                                                                                  6.451243e+08\n",
            "Name: total_vaccinations, Length: 84, dtype: float64\n",
            "\n",
            "Cantidad total de vacunas aplicadas en todo el mundo: 2002854013761.0\n",
            "\n",
            "Promedio de vacunas aplicadas por país:\n",
            "country\n",
            "Afghanistan    2.566118e+06\n",
            "Albania        1.191695e+06\n",
            "Algeria        9.956086e+06\n",
            "Andorra        5.827721e+04\n",
            "Angola         6.074066e+06\n",
            "Name: total_vaccinations, dtype: float64\n",
            "\n",
            "Vacunas aplicadas el 29/01/2021: 82952931.0\n",
            "\n",
            "DataFrame con diferencias de tiempo (primeras 5 filas):\n",
            "       country iso_code       date  total_vaccinations  people_vaccinated  \\\n",
            "0  Afghanistan      AFG 2021-02-22                 0.0                0.0   \n",
            "1  Afghanistan      AFG 2021-02-23                 NaN                NaN   \n",
            "2  Afghanistan      AFG 2021-02-24                 NaN                NaN   \n",
            "3  Afghanistan      AFG 2021-02-25                 NaN                NaN   \n",
            "4  Afghanistan      AFG 2021-02-26                 NaN                NaN   \n",
            "\n",
            "   people_fully_vaccinated  daily_vaccinations_raw  daily_vaccinations  \\\n",
            "0                      NaN                     NaN                 NaN   \n",
            "1                      NaN                     NaN              1367.0   \n",
            "2                      NaN                     NaN              1367.0   \n",
            "3                      NaN                     NaN              1367.0   \n",
            "4                      NaN                     NaN              1367.0   \n",
            "\n",
            "   total_vaccinations_per_hundred  people_vaccinated_per_hundred  \\\n",
            "0                             0.0                            0.0   \n",
            "1                             NaN                            NaN   \n",
            "2                             NaN                            NaN   \n",
            "3                             NaN                            NaN   \n",
            "4                             NaN                            NaN   \n",
            "\n",
            "   people_fully_vaccinated_per_hundred  daily_vaccinations_per_million  \\\n",
            "0                                  NaN                             NaN   \n",
            "1                                  NaN                            34.0   \n",
            "2                                  NaN                            34.0   \n",
            "3                                  NaN                            34.0   \n",
            "4                                  NaN                            34.0   \n",
            "\n",
            "                                            vaccines  \\\n",
            "0  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "1  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "2  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "3  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "4  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "\n",
            "                 source_name            source_website  date_difference  \n",
            "0  World Health Organization  https://covid19.who.int/              NaN  \n",
            "1  World Health Organization  https://covid19.who.int/              1.0  \n",
            "2  World Health Organization  https://covid19.who.int/              1.0  \n",
            "3  World Health Organization  https://covid19.who.int/              1.0  \n",
            "4  World Health Organization  https://covid19.who.int/              1.0  \n",
            "\n",
            "DataFrame con cantidad total por país:\n",
            "       country  total_vaccinations_by_country\n",
            "0  Afghanistan                    118041426.0\n",
            "1      Albania                    295540465.0\n",
            "2      Algeria                    238946062.0\n",
            "3      Andorra                      2447643.0\n",
            "4       Angola                    388740243.0\n",
            "\n",
            "Registros antes del 20/12/2020 (primeras 5 filas):\n",
            "      country iso_code       date  total_vaccinations  people_vaccinated  \\\n",
            "13403  Canada      CAN 2020-12-14                 5.0                5.0   \n",
            "13404  Canada      CAN 2020-12-15               727.0              727.0   \n",
            "13405  Canada      CAN 2020-12-16              3025.0             3025.0   \n",
            "13406  Canada      CAN 2020-12-17              7279.0             7279.0   \n",
            "13407  Canada      CAN 2020-12-18             11296.0            11296.0   \n",
            "\n",
            "       people_fully_vaccinated  daily_vaccinations_raw  daily_vaccinations  \\\n",
            "13403                      NaN                     NaN                 NaN   \n",
            "13404                      NaN                   722.0               722.0   \n",
            "13405                      NaN                  2298.0              1510.0   \n",
            "13406                      NaN                  4254.0              2425.0   \n",
            "13407                      NaN                  4017.0              2823.0   \n",
            "\n",
            "       total_vaccinations_per_hundred  people_vaccinated_per_hundred  \\\n",
            "13403                            0.00                           0.00   \n",
            "13404                            0.00                           0.00   \n",
            "13405                            0.01                           0.01   \n",
            "13406                            0.02                           0.02   \n",
            "13407                            0.03                           0.03   \n",
            "\n",
            "       people_fully_vaccinated_per_hundred  daily_vaccinations_per_million  \\\n",
            "13403                                  NaN                             NaN   \n",
            "13404                                  NaN                            19.0   \n",
            "13405                                  NaN                            40.0   \n",
            "13406                                  NaN                            64.0   \n",
            "13407                                  NaN                            74.0   \n",
            "\n",
            "                                                vaccines  \\\n",
            "13403  Johnson&Johnson, Moderna, Oxford/AstraZeneca, ...   \n",
            "13404  Johnson&Johnson, Moderna, Oxford/AstraZeneca, ...   \n",
            "13405  Johnson&Johnson, Moderna, Oxford/AstraZeneca, ...   \n",
            "13406  Johnson&Johnson, Moderna, Oxford/AstraZeneca, ...   \n",
            "13407  Johnson&Johnson, Moderna, Oxford/AstraZeneca, ...   \n",
            "\n",
            "                                             source_name  \\\n",
            "13403  Official data from provinces via covid19tracke...   \n",
            "13404  Official data from provinces via covid19tracke...   \n",
            "13405  Official data from provinces via covid19tracke...   \n",
            "13406  Official data from provinces via covid19tracke...   \n",
            "13407  Official data from provinces via covid19tracke...   \n",
            "\n",
            "                                          source_website  \n",
            "13403  https://covid19tracker.ca/vaccinationtracker.html  \n",
            "13404  https://covid19tracker.ca/vaccinationtracker.html  \n",
            "13405  https://covid19tracker.ca/vaccinationtracker.html  \n",
            "13406  https://covid19tracker.ca/vaccinationtracker.html  \n",
            "13407  https://covid19tracker.ca/vaccinationtracker.html  \n",
            "\n",
            "Registros de la vacuna Pfizer (primeras 5 filas):\n",
            "       country iso_code       date  total_vaccinations  people_vaccinated  \\\n",
            "0  Afghanistan      AFG 2021-02-22                 0.0                0.0   \n",
            "1  Afghanistan      AFG 2021-02-23                 NaN                NaN   \n",
            "2  Afghanistan      AFG 2021-02-24                 NaN                NaN   \n",
            "3  Afghanistan      AFG 2021-02-25                 NaN                NaN   \n",
            "4  Afghanistan      AFG 2021-02-26                 NaN                NaN   \n",
            "\n",
            "   people_fully_vaccinated  daily_vaccinations_raw  daily_vaccinations  \\\n",
            "0                      NaN                     NaN                 NaN   \n",
            "1                      NaN                     NaN              1367.0   \n",
            "2                      NaN                     NaN              1367.0   \n",
            "3                      NaN                     NaN              1367.0   \n",
            "4                      NaN                     NaN              1367.0   \n",
            "\n",
            "   total_vaccinations_per_hundred  people_vaccinated_per_hundred  \\\n",
            "0                             0.0                            0.0   \n",
            "1                             NaN                            NaN   \n",
            "2                             NaN                            NaN   \n",
            "3                             NaN                            NaN   \n",
            "4                             NaN                            NaN   \n",
            "\n",
            "   people_fully_vaccinated_per_hundred  daily_vaccinations_per_million  \\\n",
            "0                                  NaN                             NaN   \n",
            "1                                  NaN                            34.0   \n",
            "2                                  NaN                            34.0   \n",
            "3                                  NaN                            34.0   \n",
            "4                                  NaN                            34.0   \n",
            "\n",
            "                                            vaccines  \\\n",
            "0  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "1  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "2  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "3  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "4  Johnson&Johnson, Oxford/AstraZeneca, Pfizer/Bi...   \n",
            "\n",
            "                 source_name            source_website  \n",
            "0  World Health Organization  https://covid19.who.int/  \n",
            "1  World Health Organization  https://covid19.who.int/  \n",
            "2  World Health Organization  https://covid19.who.int/  \n",
            "3  World Health Organization  https://covid19.who.int/  \n",
            "4  World Health Organization  https://covid19.who.int/  \n",
            "\n",
            "Todos los DataFrames se han guardado en el archivo Excel en la ruta:\n",
            "/content/vaccination_data.xlsx\n"
          ]
        }
      ]
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "toc_visible": true,
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}